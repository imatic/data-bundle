imports:
    - { resource: parameters.xml }
    - { resource: '@ImaticDataBundle/Resources/config/data_doctrine.yml' }
    - { resource: '@ImaticDataBundle/Resources/config/data_doctrine_orm.yml' }
    - { resource: '@ImaticDataBundle/Resources/config/data_doctrine_dbal.yml' }
    - { resource: '@ImaticDataBundle/Resources/config/config.yml' }

framework:
    secret:                     test
    test: ~
    session:
        storage_id:             session.storage.filesystem
    form:                       true
    csrf_protection:            true
    validation:
        enabled:                true
        enable_annotations:     true
    translator:
        enabled:                true
    router:
        resource:               %kernel.root_dir%/config/routing.yml
    templating:
        engines:                [twig]
    default_locale:             cs_CZ
    profiler:                   { only_exceptions: false }

twig:
    debug:                      %kernel.debug%
    strict_variables:           %kernel.debug%

doctrine:
    dbal:
        connections:
            default:
                wrapper_class: "Imatic\\Bundle\\TestingBundle\\Doctrine\\DBAL\\PersistedConnection"

#               sqlite
#                driver:         pdo_sqlite
#                memory:         false
#                path:           %kernel.root_dir%/cache/test.db

#                postgres
                driver:         '%database.driver%'
                host:           '%database.host%'
                dbname:         '%database.name%'
                user:           '%database.user%'
                password:       '%database.pass%'
                port:           '%database.port%'
                # server_version is needed in order make the project work with dbal 2.5
                # see: https://github.com/doctrine/DoctrineBundle/issues/351
                server_version: '%database.server_version%'

    orm:
        auto_generate_proxy_classes: %kernel.debug%
        auto_mapping:           true
        resolve_target_entities: []
        naming_strategy: doctrine.orm.naming_strategy.underscore
        dql:
            string_functions:
                ilike: Imatic\Bundle\DataBundle\Doctrine\Postgresql\Query\AST\ILike
                not_ilike: Imatic\Bundle\DataBundle\Doctrine\Postgresql\Query\AST\NotILike
                unaccent_lower: Imatic\Bundle\DataBundle\Doctrine\Common\Query\AST\UnaccentLower

monolog:
    handlers:
        main:
          type:                 "null"

security:
    encoders:
        Symfony\Component\Security\Core\User\User: plaintext

    role_hierarchy:
        ROLE_ADMIN:             ROLE_USER
        ROLE_SUPER_ADMIN:       [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

    providers:
        in_memory:
            memory:
                users:
                    user:
                        password: password
                        roles:  [ROLE_SUPER_ADMIN]

    firewalls:
        main:
            provider:           in_memory
            context:            user
            pattern:            /admin/(.*)
            http_basic:
            anonymous:          false
